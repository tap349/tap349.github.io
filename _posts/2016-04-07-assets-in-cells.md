---
layout: post
title: assets in cells
date: 2016-04-07 02:01:46 +0300
access: public
categories: [rails, assets, cells]
---

how to bundle assets in cell's view directory.

<!-- more -->

<http://trailblazer.to/gems/cells/rails.html#asset-pipeline>

## basics

- add _app/cells/_ to assets paths

  _config/initializers/assets.rb_:

  ```ruby
  Rails.application.config.assets.paths << Rails.root.join('app', 'cells')
  ```

  now it's possible to `require` assets in application manifests
  relative to _app/cells/_.

- create _cells.sass_ and _cells.coffee_ and require them in application manifests

  _cells.sass_:

  ```sass
  /*
  * require all concept stylesheets explicitly
  *
  *= require billing/accounting_act/accounting_act
  */
  ```

- precompile _cells.css_

  as a rule assets are precompiled in production
  (not all assets - only _application.css_ and _application.js_)

  it's possible to precompile _cells.sass_ for production in 2 ways:

  - manually in _config/initializers/assets.rb_:

    ```ruby
    Rails.application.config.assets.precompile += %w(cells.css cells.js)
    ```

  - by requiring it in _application.coffee_:

    ```coffee
    /*
     *= require cells
     */
    ```

## using asset tag helpers

<http://trailblazer.to/gems/cells/helpers.html#asset-helpers>

asset tag helpers provided by `Cell::ViewModel` ignore Rails assets prefix
(`/assets`) - they use different prefixes for stylesheets (`/stylesheets`),
javascripts (`/javascripts`), etc.
as a result sprockets cannot find assets using URLs generated by these helpers.

including `ActionView::Helpers::AssetTagHelper` doesn't help.

**solution**: use original asset tag helpers provided by controller's view context.

_cells/billing/accounting_act_cell.rb_:

```ruby
class Billing::AccountingActCell < Cell::ViewModel
  delegate :wicked_pdf_stylesheet_link_tag, to: :view_context
  ...
private

  def view_context
    parent_controller.view_context
  end
  ...
end
```
