---
layout: post
title: Nginx
date: 2018-04-24 13:45:02 +0300
access: public
comments: true
categories: [nginx]
---

<!-- @format -->

<!-- more -->

<!-- prettier-ignore -->
* TOC
{:toc}
<hr>

1. <https://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms>
2. <https://www.digitalocean.com/community/tutorials/understanding-nginx-http-proxying-load-balancing-buffering-and-caching>

## notes

### forward vs. reverse proxy

1. <https://stackoverflow.com/questions/224664/difference-between-proxy-server-and-reverse-proxy-server>

> <https://stackoverflow.com/a/366212/3632318>
>
> What is different this time compared to a "forward proxy", is that this time
> the user X does not know he is accessing Z, because the user X only sees he is
> communicating with Y. The server Z is invisible to clients and only the
> reverse proxy Y is visible externally. A reverse proxy requires no (proxy)
> configuration on the client side.

> <https://stackoverflow.com/a/14190390/3632318>
>
> A proxy is simply a middleman for communication (requests+responses): Client
> <-> Proxy <-> Server
>
> - Client proxy: ( Client <-> Proxy ) <-> Server
>
>   The proxy acts on behalf of the client. Client knows about all 3 machines
>   involved in chain. Server doesn't.
>
> - Server proxy: Client <-> ( Proxy <-> Server )
>
>   The proxy acts on behalf of the server. Client only knows about proxy.
>   Server knows whole chain.
>
> Seems to me that forward and reverse are simply confusing,
> perspective-dependent names for client and server proxy.

<https://stackoverflow.com/a/28001462/3632318>:

![forward proxy](https://i.stack.imgur.com/MPQAt.png)

![reverse proxy](https://i.stack.imgur.com/xrOba.png)

## tips

### reload/restart Nginx

for some reason restarting Nginx service using init.d script doesn't work (most
likely `start-stop-daemon` used internally doesn't stop it correctly):

```sh
$ sudo service nginx restart
```

instead it's possible to restart Nginx manually:

- send `reload` signal

  this reloads Nginx configuration only - without restarting service itself:

  ```sh
  $ sudo /opt/nginx-1.2.9/sbin/nginx -s reload
  ```

- or else send `stop` signal and start Nginx service as usual

  ```sh
  $ sudo /opt/nginx-1.2.9/sbin/nginx -s stop
  $ sudo service nginx start
  ```

### proxy POST requests

1. <https://serverfault.com/a/312114>

POST requests are passed to proxy just like GET requests, no additional
configuration is required.
