---
layout: post
title: Git - Tips
date: 2017-04-29 02:20:32 +0300
access: public
categories: [git]
---
<!-- more -->

## [how to] undo `git reset HEAD~`

<http://stackoverflow.com/questions/2510276/undoing-git-reset>

```sh
$ git reset 'HEAD@{1}'
```

or

```sh
$ git reset ORIG_HEAD
```

## [how to] fork a fork and sync it with original repo

- <https://help.github.com/articles/syncing-a-fork/>

<https://github.com/r-icarus/detergentex.git>
<br>-> <https://github.com/danxexe/detergentex> (fork with changes I need)
<br>-> <https://githbu.com/tap349/detergentex> (my fork)

what I want to get in the end is to use a fork synced with original repo.

```sh
$ git clone git@github.com:tap349/detergentex.git
$ git checkout feature/httpc-options-fork
$ git remote -v
$ git remote add upstream https://github.com/r-icarus/detergentex.git
$ git checkout master
$ git fetch upstream
$ git merge upstream/master
$ git checkout feature/httpc-options-fork
$ git rebase master
$ git mergetool
/ resolve conflicts
$ git rebase --continue
$ git clean -f
$ git push -f
```

## [how to] sign GitHub commits

1. <https://help.github.com/articles/generating-a-new-gpg-key/>
2. <https://help.github.com/articles/associating-an-email-with-your-gpg-key/>
3. <https://help.github.com/articles/signing-commits-using-gpg/>

additional configuration:

### _~/.zshenv_

- add `-S` flag to `git commit` command in all aliases
- export `GPG_TTY` environment variable

  1. <https://github.com/keybase/keybase-issues/issues/1712#issuecomment-141226705>

  ```zsh
  export GPG_TTY=$(tty)
  ```

  without it Git will fail to sign commits:

  ```
  $ git commit -S -m "foo"
  error: gpg failed to sign the data
  fatal: failed to write commit object
  ```

### _~/.gitconfig_

- set commit email (required)

  ```sh
  $ git config --global user.email <GitHub verified email>
  ```

  if Git email doesn't match GitHub email,
  commit will have `Unverified` badge on GitHub).

- set signing key (optional)

  1. <https://stackoverflow.com/questions/41052538/git-error-gpg-failed-to-sign-data>

  ```sh
  $ gpg --list-keys --keyid-format LONG
  /Users/tap/.gnupg/pubring.gpg
  -----------------------------
  pub   rsa4096/ACFDF508F789A2CB 2017-10-17 [SC]
        D9CA996601640B2121F29312ACFDF508F789A2CB
  ...
  $ git config --global user.signingkey <GPG key ID>
  ```

  here `ACFDF508F789A2CB` is a my GPG key ID (long format) and
  `D9CA996601640B2121F29312ACFDF508F789A2CB` is a fingerprint.

  I guess, setting signing key explicitly might be required if
  you have more than one signing key. 
