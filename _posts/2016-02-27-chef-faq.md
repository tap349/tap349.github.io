---
layout: post
title: chef FAQ
date: 2016-02-27 01:16:00 +0300
access: public
categories: [chef]
---

FAQ

<!-- more -->

# how knife connects to node?

## knife-solo

### bootstrapping

  it's possible to connect to node using:

  - domain or IP address

    current user is used unless it's specified explicitly
    (user@domain or user@ip).

    you are always prompted to enter password.

  - host from SSH config

    passwordless authentication is used.

  - user@ip

    passwordless authentication is used if
    corresponding entry in SSH config is found.

    user can be specified with `knife[:ssh_user]` option in _knife.rb_.

  knife-solo creates new node file in _nodes/_ after bootstrapping the node.

  node file name:

    - domain (when using domain/host to bootstrap the node)
    - IP address (when using IP address).

### cooking

  when using knife-solo and chef-solo there is no chef server where
  information about nodes might be stored.
  that is why knife connects to node in the same way as described above
  for bootstraping.

  cooking:

  - chef repo is uploaded to _~/chef-solo/_ directory in
    specified user's home directory
  - chef-solo searches for node file in uploaded chef repo -
    node file name must be the same as domain or IP address used
    to connect to the node. if such node file is not found
    chef-solo creates a new one with empty run-list
  - chef-solo provisions the node using node file
    (it is created if it doesn't exist - see previous step)

## knife-zero

### bootstrapping

  same as file for knife-solo except that it's possible to specify
  node name with `--node-name` option when bootstrapping the node -
  node file will have specified name.

  if using host from SSH config it's used as a node name.

### cooking

  TODO: about `knife[:attribute]` option.

  cooking differs for knife-zero in that node configuration is stored on
  local chef-zero server: changing host, domain or IP address in either
  SSH config or node file itself has no effect on cooking (converging).

  when we converge we **search** for node on chef-zero server:

  ```sh
  $ knife zero converge 'name:cdnreenter'
  ```

  node configuration can be viewed with `knife node show NODE -z` command.
